import{u as C,j as e,X as A,m as D,i as S,M as I,l as P,h as i}from"./index-DNUMW6e8.js";import{r as n}from"./react-vendor-nf7bT_Uh.js";import{P as N}from"./package-CV2gnZz9.js";import{L}from"./loader-circle-BxrLM6NC.js";import{T}from"./truck-3yKFS4DX.js";import"./swiper-vendor-y1f9feYf.js";const R="https://softcream-api.mahmoud-zahran20025.workers.dev",B=({isOpen:c,onClose:o,initialOrderId:d=""})=>{var j,k;const{t:O,currentLang:t}=C(),[y,h]=n.useState(d),[a,u]=n.useState(null),[b,f]=n.useState(!1),[p,x]=n.useState(null);n.useEffect(()=>{c&&d&&(h(d),m(d))},[c,d]);const m=async(r=y)=>{if(!r||!r.trim()){x(t==="ar"?"الرجاء إدخال رقم الطلب":"Please enter order ID");return}f(!0),x(null),u(null);try{const s=await(await fetch(`${R}?path=/orders/track&orderId=${encodeURIComponent(r.trim())}`)).json();if(s.success&&s.data)u(s.data),console.log("✅ Order tracked:",s.data);else throw new Error(s.message||"Order not found")}catch(l){console.error("❌ Tracking failed:",l),x(l.message||(t==="ar"?"فشل تتبع الطلب":"Failed to track order"))}finally{f(!1)}},w=()=>{const r=[{key:"confirmed",icon:i,labelAr:"تم التأكيد",labelEn:"Confirmed"},{key:"preparing",icon:N,labelAr:"قيد التحضير",labelEn:"Preparing"},{key:"ready",icon:i,labelAr:"جاهز",labelEn:"Ready"},{key:"out_for_delivery",icon:T,labelAr:"في الطريق",labelEn:"Out for Delivery"},{key:"delivered",icon:i,labelAr:"تم التوصيل",labelEn:"Delivered"}],l=(a==null?void 0:a.status)||"confirmed",s=r.findIndex(g=>g.key===l);return r.map((g,v)=>({...g,isActive:v<=s,isCurrent:v===s}))},E=r=>r?new Date(r).toLocaleDateString(t==="ar"?"ar-EG":"en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):"";return c?e.jsx("div",{className:"fixed inset-0 bg-gray-900/80 backdrop-blur-md z-[9200] flex items-center justify-center p-5 overflow-y-auto",onClick:o,children:e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-3xl p-8 max-w-[650px] w-full max-h-[90vh] overflow-y-auto shadow-2xl relative",onClick:r=>r.stopPropagation(),children:[e.jsx("button",{className:"absolute top-4 right-4 bg-gray-100 dark:bg-gray-700 w-10 h-10 rounded-full flex items-center justify-center hover:bg-red-500 hover:text-white transition-all",onClick:o,children:e.jsx(A,{className:"w-5 h-5"})}),e.jsxs("div",{className:"text-center mb-7",children:[e.jsx("div",{className:"w-16 h-16 bg-gradient-to-br from-primary to-primary-dark rounded-full flex items-center justify-center mx-auto mb-4 text-white shadow-lg",children:e.jsx(N,{className:"w-8 h-8"})}),e.jsx("h3",{className:"text-[26px] font-black text-gray-800 dark:text-gray-100 mb-2",children:t==="ar"?"تتبع الطلب":"Track Order"}),e.jsx("p",{className:"text-base text-gray-600 dark:text-gray-400",children:t==="ar"?"أدخل رقم الطلب لتتبع حالته":"Enter order ID to track status"})]}),e.jsx("div",{className:"mb-6",children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"text",className:"flex-1 px-4 py-3 border-2 border-gray-300 rounded-xl focus:border-primary transition-all",placeholder:t==="ar"?"رقم الطلب (مثال: ORD-123456)":"Order ID (e.g., ORD-123456)",value:y,onChange:r=>h(r.target.value),onKeyPress:r=>r.key==="Enter"&&m(),dir:"ltr"}),e.jsxs("button",{className:"px-6 py-3 bg-gradient-to-r from-primary to-primary-dark text-white rounded-xl font-bold hover:shadow-lg transition-all disabled:opacity-50 flex items-center gap-2",onClick:()=>m(),disabled:b,children:[b?e.jsx(L,{className:"w-5 h-5 animate-spin"}):e.jsx(D,{className:"w-5 h-5"}),t==="ar"?"بحث":"Search"]})]})}),p&&e.jsx("div",{className:"mb-6 p-4 bg-red-50 border-2 border-red-500 rounded-xl text-red-600 text-sm",children:p}),a&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-gradient-to-br from-pink-50 to-purple-50 dark:from-gray-700 dark:to-gray-600 rounded-2xl p-5 border-2 border-pink-100 dark:border-gray-600",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:t==="ar"?"رقم الطلب":"Order ID"}),e.jsxs("div",{className:"text-lg font-bold text-gray-800 dark:text-gray-100",children:["#",a.id]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:t==="ar"?"التاريخ":"Date"}),e.jsx("div",{className:"text-sm font-semibold text-gray-800 dark:text-gray-100",children:E(a.createdAt)})]})]}),a.customer&&e.jsxs("div",{className:"space-y-2 text-sm",children:[a.customer.phone&&e.jsxs("div",{className:"flex items-center gap-2 text-gray-700 dark:text-gray-300",children:[e.jsx(S,{className:"w-4 h-4"}),e.jsx("span",{dir:"ltr",children:a.customer.phone})]}),a.customer.address&&e.jsxs("div",{className:"flex items-center gap-2 text-gray-700 dark:text-gray-300",children:[e.jsx(I,{className:"w-4 h-4"}),e.jsx("span",{children:a.customer.address})]})]})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-700 rounded-2xl p-5 border-2 border-gray-200 dark:border-gray-600",children:[e.jsx("h4",{className:"font-bold text-gray-800 dark:text-gray-100 mb-4",children:t==="ar"?"حالة الطلب":"Order Status"}),e.jsx("div",{className:"space-y-4",children:w().map((r,l)=>{const s=r.icon;return e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:`w-10 h-10 rounded-full flex items-center justify-center ${r.isActive?"bg-primary text-white":"bg-gray-200 text-gray-400"} ${r.isCurrent?"ring-4 ring-primary/30":""}`,children:e.jsx(s,{className:"w-5 h-5"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:`font-semibold ${r.isActive?"text-gray-800 dark:text-gray-100":"text-gray-400"}`,children:t==="ar"?r.labelAr:r.labelEn}),r.isCurrent&&a.eta&&e.jsxs("div",{className:"text-xs text-gray-500 dark:text-gray-400 flex items-center gap-1 mt-1",children:[e.jsx(P,{className:"w-3 h-3"}),e.jsx("span",{children:a.eta})]})]}),r.isActive&&e.jsx(i,{className:"w-5 h-5 text-green-500"})]},r.key)})})]}),a.items&&a.items.length>0&&e.jsxs("div",{className:"bg-white dark:bg-gray-700 rounded-2xl p-5 border-2 border-gray-200 dark:border-gray-600",children:[e.jsx("h4",{className:"font-bold text-gray-800 dark:text-gray-100 mb-4",children:t==="ar"?"المنتجات":"Items"}),e.jsxs("div",{className:"space-y-2",children:[a.items.map((r,l)=>{var s;return e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsxs("span",{className:"text-gray-700 dark:text-gray-300",children:[r.name," × ",r.quantity]}),e.jsxs("span",{className:"font-bold text-gray-800 dark:text-gray-100",children:[(s=r.total)==null?void 0:s.toFixed(2)," ج.م"]})]},l)}),e.jsxs("div",{className:"pt-2 border-t border-gray-300 dark:border-gray-500 flex justify-between font-bold text-base",children:[e.jsx("span",{className:"text-gray-800 dark:text-gray-100",children:t==="ar"?"الإجمالي:":"Total:"}),e.jsxs("span",{className:"text-primary",children:[(k=(j=a.totals)==null?void 0:j.total)==null?void 0:k.toFixed(2)," ج.م"]})]})]})]})]}),e.jsx("button",{className:"mt-6 w-full py-4 bg-gray-200 dark:bg-gray-700 text-gray-800 dark:text-gray-100 rounded-2xl font-bold hover:bg-gray-300 dark:hover:bg-gray-600 transition-all",onClick:o,children:t==="ar"?"إغلاق":"Close"})]})}):null};export{B as default};
